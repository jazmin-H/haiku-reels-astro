---
import HaikuSection from "@components/haiku-section.astro";
---

<HaikuSection>
	<div class="relative h-full flex flex-col">
		<div class="absolute h-full w-full" container-bg-lamparas></div>
		<div class="flex flex-col h-full">
			<div class="grow-[2]"></div>
			<div class="relative z-10">
				<slot />
			</div>
			<div class="grow"></div>
		</div>
	</div>
	<script>
		import { createBodies } from "./bodies";
		import { createCanvasByContainer } from "@utils/matterjs/canvas";
		import { Engine } from "@utils/matterjs/engine";
		import Matter from "matter-js";

		const containers = document.querySelectorAll(`[container-bg-lamparas]`);
		containers.forEach((container) => {
			const canvas = createCanvasByContainer(container);
			const bodies = createBodies(canvas);
			const updateEngine = Matter.Engine.create();
			const wind = Matter.Vector.create(0.4, -0.4);
			Matter.Events.on(updateEngine, "beforeUpdate", () => {
				bodies.forEach((body) => {
					Matter.Body.setVelocity(body, wind);
				});
			});
			const engine = new Engine({
				canvas,
				bodies,
				engine: updateEngine,
			});

			engine.start();
		});
	</script>
</HaikuSection>
