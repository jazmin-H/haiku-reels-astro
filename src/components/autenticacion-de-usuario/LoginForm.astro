---
import { useState } from "react";
import pb from "../../utils/matterjs/pocketbase.js";

let error = "";
let success = "";

async function handleSubmit(e) {
  e.preventDefault();

  const email = e.target.email.value.trim();
  const password = e.target.password.value.trim();

  try {
    await pb.collection("users").authWithPassword(email, password);
    success = "Inicio de sesión exitoso.";
    error = "";
    // Redirigir al perfil
    window.location.href = "/autenticacion/perfil";
  } catch (err) {
    error = "Credenciales incorrectas o usuario inexistente.";
    success = "";
    console.error("Error al iniciar sesión:", err);
  }
}
---

<form onSubmit={handleSubmit} class="flex flex-col gap-4 p-4 bg-paynes_grey rounded-lg text-white">
  <h2 class="text-xl font-bold mb-2">Iniciar sesión</h2>

  <input type="email" name="email" placeholder="Correo electrónico" required class="p-2 rounded bg-delft_blue" />
  <input type="password" name="password" placeholder="Contraseña" required class="p-2 rounded bg-delft_blue" />

  <button type="submit" class="bg-atomic_tangerine text-white p-2 rounded mt-2 hover:bg-orange-500 transition">
    Iniciar sesión
  </button>

  {error && <p class="text-red-400 mt-2">{error}</p>}
  {success && <p class="text-green-400 mt-2">{success}</p>}
</form>
